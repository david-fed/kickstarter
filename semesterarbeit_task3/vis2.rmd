---
title: "Visualization 2"
output: html_document
---
# Vis 2

```{r, message = FALSE, warning = FALSE}
library(plotly)
library(countrycode)

country.freq <- table(kickstarter$Country)
country.rel.freq <- round(country.freq / length(kickstarter$Country) * 100, digits = 2)

# dark grey boundaries
l <- list(color = toRGB("darkgray"), width = 0.5)

# specify map projection/options
g <- list(
    showframe = FALSE,
    showcoastlines = TRUE,
    coastlinecolor = toRGB("lightgray"),
    showland = TRUE,
    landcolor = toRGB("lightgray"),
    showocean = TRUE,
    oceancolor = toRGB("white"),
    showcountries = TRUE,
    countrycolor = toRGB("darkgray"),
    projection = list(type = "Mercator")
)

fig <- plot_geo(kickstarter)
fig <- fig %>% add_trace(
    z = log10(country.freq),
    color = log10(country.freq),
    text = paste("<b>Country:</b>", names(country.freq),
    "<br><b>Projects:</b>", format(country.freq, big.mark="'"),
    "<br><b>Relative:</b>", paste0(country.rel.freq, "%")
    ),
    locations = countrycode(names(country.freq), "country.name", "iso3c"),
    marker = list(line = l, type = "log"),
    hovertemplate = paste(
        "%{text}<extra></extra>"
    )
)

country.log_max_min <- seq(floor(log10(min(country.freq))), ceiling(log10(max(country.freq))), by = 1)

fig <- fig %>% colorbar(
    title = "Amount of projects",
    tickvals = country.log_max_min,
    ticktext = 10^country.log_max_min
)

m <- list(
  l = 0,
  r = 20,
  b = 0,
  t = 20,
  pad = 4
)

fig <- fig %>% layout(
    title = list(text = "Amount of Kickstarter projects per country", yanchor = "top"),
    width = 1000,
    margin = m,
    geo = g
)

fig
```